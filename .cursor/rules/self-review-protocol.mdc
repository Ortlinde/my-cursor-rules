---
description: AI Self-Review Protocol - Mandatory code review trigger
globs: .cs
alwaysApply: true
---

# AI Self-Review Protocol (MANDATORY)

> Trigger file only. Full review logic lives in `.cursor/agents/code-reviewer.md`.

## Trigger Conditions

- [ ] **MUST**: Perform self-review when ANY of the following occurs
  - Modified or added >50 lines of code
  - Refactored existing functionality
  - Added new class, method, or interface
  - Modified architecture or dependencies
  - Touched Unity lifecycle or event system
  - Made unsolicited optimizations

## Execution

- [ ] **MUST**: When ANY trigger condition is met
  - Step 1: Launch `code-reviewer` subagent (Task tool, subagent_type="code-reviewer")
  - Step 2: Include the subagent's Self-Review Report in response to Admin
  - Step 3: Follow the subagent's decision (Proceed / Warning / STOP)
  - DO NOT: Skip review even if changes seem safe

## Fallback (If Subagent Unavailable)

- [ ] **MUST**: If subagent cannot be launched, perform inline abbreviated check
  - Check against `my-base-rules.mdc` (file length, params, SOLID, DRY, scope)
  - Check against `postmortem-patterns.mdc` (known bug patterns)
  - Produce abbreviated report: Summary + Failed Checks only
  - If failures >= 3: STOP and propose 3 solution options to Admin

## Exemptions

- [ ] **MAY**: Skip detailed review (but still provide brief summary) when:
  - Modified <10 lines AND only comments/formatting
  - Deleted unused code only
  - Pure data class (POCO/DTO) with no logic
  - Admin explicitly requests "skip review"
