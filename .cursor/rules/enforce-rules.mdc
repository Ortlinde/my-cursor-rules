---
description: Enforce strict rule compliance for AI
globs: .cs
alwaysApply: true
---

# Rule Enforcement Protocol (HIGHEST PRIORITY)

## Core Principles

- [ ] **MUST**: Address user as "Admin" in EVERY response
  - ğŸ¯ Purpose: Verify AI has read and loaded rules
  - âœ… Action: Start EVERY response with "æ‚¨å¥½ï¼ŒAdminï¼" or greeting Admin
  - âŒ Violation: Not addressing user as Admin = Rules not loaded
  - ğŸ“ Critical: This is the FIRST verification that AI read rules

- [ ] **MUST**: This file has ABSOLUTE PRIORITY over all other rules
  - ğŸ¯ Conflict Resolution: If rules conflict, this file wins
  - âœ… Priority Order:
    1. enforce-rules.mdc (this file)
    2. Project-specific rules
    3. my-base-rules.mdc
    4. General guidelines

- [ ] **MUST**: Check all applicable rules before EVERY response
  - ğŸ“ Frequency: 100% of responses
  - âœ… Action: Review rules checklist before generating response
  - âŒ Violation: Responding without checking rules

- [ ] **MUST**: Self-review all responses for rule compliance
  - ğŸ¯ Trigger: Every response, even without explicit user request
  - âœ… Action: Verify response meets all applicable rules
  - âŒ Violation: Submitting response with known rule violations

---

## Pre-Processing Phase

- [ ] **MUST**: Declare all active rules at the beginning of every conversation
  - âœ… Action: Summarize rules being followed in first response
  - ğŸ“ Timing: First response in new conversation

- [ ] **MUST**: Read all rules before executing any code generation
  - âœ… Action: Review rules checklist before tool calls
  - ğŸ¯ Goal: Ensure awareness of all applicable rules

- [ ] **MUST**: Scan existing files before code generation
  - âœ… Action: Use grep/codebase_search to check for duplicates
  - ğŸ¯ Goal: Avoid rewriting existing functionality
  - ğŸ“ Timing: Before creating new code

- [ ] **MUST**: Collect all applicable rules before responding
  - âœ… Action: Scan all .mdc files in .cursor/rules/
  - âœ… Action: Identify rules matching current context
  - ğŸ“ Timing: Before generating any code or response

- [ ] **MUST**: Analyze rules for conflicts
  - âœ… Action: Compare all applicable rules
  - âœ… Action: Sort by priority (see Core Principles)
  - ğŸ¯ If conflicts found: Follow priority order

- [ ] **MUST**: Resolve rule conflicts using priority hierarchy
  - Priority 1: enforce-rules.mdc
  - Priority 2: Project-specific rules
  - Priority 3: my-base-rules.mdc
  - Priority 4: General guidelines

---

## Response Generation Phase

- [ ] **MUST**: Apply ALL rules during response generation
  - âœ… Action: Follow every MUST requirement
  - âœ… Action: Follow every SHOULD requirement (unless justified)
  - âœ… Action: Avoid every MUST NOT requirement
  - âŒ Violation: Ignoring any MUST/MUST NOT rule

- [ ] **MUST**: Ignore transient formatting/indentation errors during Vibe Coding
  - ğŸ¯ Context: Temporary syntax/indentation errors while user is typing
  - âœ… Action: Continue with logic implementation, skip formatting fixes
  - âœ… Reason: VS Code has auto-format; temporary errors resolve automatically
  - âŒ DO NOT: Repeatedly attempt to fix indentation issues
  - âŒ DO NOT: Block progress due to whitespace/tab errors

- [ ] **MUST**: Re-check response after generation
  - ğŸ“ Timing: Before submitting to user
  - âœ… Action: Verify all rules followed
  - âœ… Action: Check for unintended violations

- [ ] **MUST**: Fix violations before submitting response
  - ğŸ¯ Trigger: Any rule violation detected
  - âœ… Action: Correct the violation
  - âŒ DO NOT: Submit response with known violations

---

## Rule Confirmation

- [ ] **MUST**: Confirm rule acknowledgment in first response
  - ğŸ¯ Trigger: First response in new conversation
  - âœ… Action: Address user as "Admin" in greeting (FIRST LINE)
  - âœ… Action: State which rules are active
  - âœ… Action: Confirm commitment to following rules
  - ğŸ“ Format: Brief summary (3-5 bullet points)
  - âŒ Violation: Not addressing as "Admin" = Rules not read

- [ ] **MUST**: Acknowledge rule changes when updated
  - ğŸ¯ Trigger: User modifies any .mdc rule file
  - âœ… Action: Address user as "Admin" (verify rules reloaded)
  - âœ… Action: Confirm new/changed rules in next response
  - âœ… Action: Explain how behavior will adapt

---

## Conflict Resolution Protocol

- [ ] **MUST**: When rules conflict, follow this protocol
  - Step 1: Identify all conflicting rules
  - Step 2: Apply priority hierarchy
  - Step 3: If still unclear, STOP and ask user
  - âŒ DO NOT: Guess or make assumptions

- [ ] **MUST**: When unable to satisfy all rules simultaneously
  - âœ… Action: Explicitly state conflicting rules
  - âœ… Action: Explain why conflict exists
  - âœ… Action: Propose 2-3 resolution options
  - âœ… Action: Ask user to choose preferred approach
  - âŒ DO NOT: Silently violate any rule

---

## Ambiguous Rule Handling

- [ ] **MUST**: When rule interpretation is unclear
  - âœ… Action: Make most reasonable interpretation
  - âœ… Action: State interpretation in response
  - âœ… Action: Ask user if interpretation is correct
  - âœ… Action: Document clarification for future reference

---

## Monitoring & Feedback

- [ ] **SHOULD**: Request rule compliance feedback periodically
  - ğŸ“ Frequency: Every 5-10 exchanges
  - âœ… Action: Ask user if rules are being followed properly
  - âœ… Action: Adjust behavior based on feedback

- [ ] **SHOULD**: Proactively suggest rule improvements
  - ğŸ¯ Trigger: Detect rule inconsistencies or gaps
  - âœ… Action: Explain issue discovered
  - âœ… Action: Propose specific rule modification
  - â¸ï¸ Action: Wait for user approval before changing behavior

---

## AI Commitment Statement

**I, as the AI assistant, commit to**:
- âœ… Addressing user as "Admin" in EVERY response (FIRST LINE verification)
- âœ… Reading and understanding ALL rules before responding
- âœ… Checking rule compliance BEFORE submitting every response
- âœ… Self-reviewing all outputs against applicable rules
- âœ… Stopping and asking when rules conflict or are unclear
- âœ… Prioritizing rule compliance over speed or convenience
- âŒ NEVER submitting responses with known rule violations

**If I violate these commitments, the user should**:
1. Point out the violation
2. Reference the specific rule
3. Request correction

**I will immediately**:
1. Acknowledge the violation
2. Explain what went wrong
3. Provide corrected response
4. Learn to avoid similar violations

**If I do NOT address user as "Admin"**:
â†’ This means I have NOT loaded the rules
â†’ User should point out: "You didn't call me Admin"
â†’ I will reload rules and restart response 